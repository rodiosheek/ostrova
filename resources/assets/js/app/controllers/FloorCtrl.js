function FloorCtrl($scope, $rootScope, $location, $routeParams, mapService) {
    console.log('Floor controller');
    var jsonCoords = {
        "9a" : {
            "1" : [
                "1337,528,1050,527,1051,272,1429,271,1429,528",
                "1337,612,1563,612,1564,869,1694,869,1694,272,1429,271,1429,528,1337,528",
                "1163,612,1563,612,1564,869,1164,869",
                "899,612,1163,612,1164,869,898,869",
                "521,611,899,612,898,869,521,869",
                "455,611,521,611,521,869,255,869,256,530,356,530,356,611",
                "256,272,520,272,521,528,455,529,455,611,356,611,356,530,256,530",
                "520,272,785,272,786,529,521,528"
            ],
            "2" : [
                "1431,273,1161,272,1160,535,1432,535",
                "1702,534,1701,272,1431,273,1432,535",
                "1431,880,1702,880,1702,534,1599,535,1599,619,1432,619",
                "1046,880,1431,880,1432,619,1046,618",
                "775,879,1046,880,1046,619,776,620",
                "506,881,775,879,776,620,506,621",
                "599,535,505,534,504,273,236,272,235,881,506,881,506,620,599,620",
                "504,273,890,274,890,534,506,534"
            ]
        },
        "29a" : {
            "1" : [
                "529,496,790,497,790,716,529,716",
                "528,806,266,805,266,445,458,446,458,495,530,497",
                "267,445,267,104,529,103,529,416,458,416,458,446",
                "530,171,791,171,791,414,529,415",
                "792,415,1162,415,1163,171,792,171",
                "1163,415,1424,415,1424,170,1164,172",
                "1425,105,1685,104,1685,457,1496,456,1496,416,1425,415",
                "1424,806,1424,497,1496,496,1496,456,1686,457,1685,806",
                "1163,715,1164,496,1424,497,1424,715",
                "900,714,1163,715,1164,496,900,497"
            ],
            "2" : [
                "529,496,790,497,790,716,529,716",
                "528,806,266,805,266,445,458,446,458,495,530,497",
                "267,445,267,104,529,103,529,416,458,416,458,446",
                "530,171,791,171,791,414,529,415",
                "792,415,1162,415,1163,171,792,171",
                "1163,415,1424,415,1424,170,1164,172",
                "1425,105,1685,104,1685,457,1496,456,1496,416,1425,415",
                "1424,806,1424,497,1496,496,1496,456,1686,457,1685,806",
                "1163,715,1164,496,1424,497,1424,715",
                "900,714,1163,715,1164,496,900,497"
            ]
        },
        "30" : {
            "1" : [
                "529,496,790,497,790,716,529,716",
                "528,806,266,805,266,445,458,446,458,495,530,497",
                "267,445,267,104,529,103,529,416,458,416,458,446",
                "530,171,791,171,791,414,529,415",
                "792,415,1162,415,1163,171,792,171",
                "1163,415,1424,415,1424,170,1164,172",
                "1425,105,1685,104,1685,457,1496,456,1496,416,1425,415",
                "1424,806,1424,497,1496,496,1496,456,1686,457,1685,806",
                "1163,715,1164,496,1424,497,1424,715",
                "900,714,1163,715,1164,496,900,497"
            ],
            "2" : [
                "529,496,790,497,790,716,529,716",
                "528,806,266,805,266,445,458,446,458,495,530,497",
                "267,445,267,104,529,103,529,416,458,416,458,446",
                "530,171,791,171,791,414,529,415",
                "792,415,1162,415,1163,171,792,171",
                "1163,415,1424,415,1424,170,1164,172",
                "1425,105,1685,104,1685,457,1496,456,1496,416,1425,415",
                "1424,806,1424,497,1496,496,1496,456,1686,457,1685,806",
                "1163,715,1164,496,1424,497,1424,715",
                "900,714,1163,715,1164,496,900,497"
            ]
        },
    };
    var section = $routeParams.section;
    var floor = $routeParams.floor;
    var building = $routeParams.id;
    $scope.id = $routeParams.id;
    $scope.section = section;
    $scope.maps = jsonCoords[building][section];

    $scope.sectionInit = function () {
        $rootScope.loading = true;
        setTimeout(function () {
            $('.map-plans').svgDrawing({
                onclick: function (el) {
                    var room = el.data('alt');
                        console.log("Flats->" + room);
                    console.log(floor);
                    mapService.getRoomNumber(building,section, floor, room).then(
                        function(data) {
                            if(data.onSale != 0) {
                               $location.path('/building/' + building + '/section/' + section + '/floor/' + floor + '/room/' + room);
                            }
                        },
                        function(error) {
                            console.log(error);
                        }
                    );
                },
                onmouseover: function (el) {
                    var room = el.data('alt');
                    mapService.getRoomNumber(building,section, floor, room).then(
                        function(data) {
                            $scope.number = data;
                            if(data.onSale != 0) {
                                el.attr('opacity', 0.5);
                                $scope.message = '';
                            } else {
                                $scope.message = 'Продано';
                            }
                        },
                        function(error) {
                            console.log(error);
                        }
                    );
                    $('.rooms-popup').find('div[data-target=' + room + ']').show();

                },
                onmouseout: function (el) {
                    el.attr('opacity', 0);
                    var room = el.data('alt');
                    $('.rooms-popup').find('div[data-target=' + room + ']').hide();
                    $scope.message = '';
                }
            });
                        $rootScope.loading = false;
        }, 1000);
    };


};

app.controller('FloorCtrl', FloorCtrl);

